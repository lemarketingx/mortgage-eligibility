<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>מאי פיננסים – מחשבונים</title>
  <style>
    :root {
      --gold: #D4AF37;
      --black: #000;
      --white: #fff;
      --gray: #f5f5f5;
      --radius: 6px;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: Arial, sans-serif;
      background: var(--gray);
      color: var(--black);
      direction: rtl;
      text-align: right;
    }
    header {
      background: var(--black);
      color: var(--white);
      padding: 1rem;
      text-align: center;
    }
    nav {
      display: flex;
      justify-content: center;
      background: var(--gold);
    }
    nav button {
      background: none;
      border: none;
      color: var(--black);
      padding: 1rem 2rem;
      cursor: pointer;
      font-weight: bold;
    }
    nav button.active {
      background: var(--white);
    }
    section {
      display: none;
      padding: 1rem;
      max-width: 800px;
      margin: 1rem auto;
      background: var(--white);
      border-radius: var(--radius);
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    section.active { display: block; }
    h2 { margin-bottom: 1rem; }
    /* ---- לשונית מסלולים ---- */
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: center; }
    input, select { width: 100%; padding: 0.4rem; border: 1px solid #ccc; border-radius: var(--radius); }
    button.calc, button.remove {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      font-weight: bold;
    }
    button.calc {
      background: var(--gold);
      color: var(--black);
      margin-top: 1rem;
    }
    button.remove {
      background: #e74c3c;
      color: #fff;
    }
    .summary { margin-top: 1rem; background: #eee; padding: 1rem; border-radius: var(--radius); }
    /* ---- לשונית זכאות ---- */
    section#tab-elig label { display: block; margin: 0.5rem 0 0.2rem; font-weight: bold; }
    /* ---- לשונית הגשה ---- */
    section#tab-app label { display: block; margin: 0.5rem 0 0.2rem; font-weight: bold; }
  </style>
</head>
<body>

  <header>
    <h1>מאי פיננסים – מחשבונים</h1>
  </header>

  <nav>
    <button id="btn-plan" class="active">מחשבון מסלולים</button>
    <button id="btn-elig">מחשבון זכאות</button>
    <button id="btn-app">הגשה דיגיטלית</button>
  </nav>

  <!-- לשונית 1: מסלולים -->
  <section id="tab-plan" class="active">
    <h2>מחשבון מסלולי משכנתא</h2>
    <table id="planTable">
      <thead>
        <tr>
          <th>מסלול</th>
          <th>סכום (₪)</th>
          <th>תקופה (שנים)</th>
          <th>ריבית (% לשנה)</th>
          <th>החזר חודשי (₪)</th>
          <th>עלות כוללת (₪)</th>
          <th>הסר</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button id="addPlan" class="calc">הוסף מסלול</button>
    <div id="planSummary" class="summary"></div>
  </section>

  <!-- לשונית 2: זכאות -->
  <section id="tab-elig">
    <h2>מחשבון זכאות לנקודות</h2>
    <label for="marriageDate">תאריך נישואין:</label>
    <input type="date" id="marriageDate">

    <label for="svcH">שירות צבאי – בעל (חודשים):</label>
    <input type="number" id="svcH" value="0">

    <label for="svcW">שירות צבאי – אשה (חודשים):</label>
    <input type="number" id="svcW" value="0">

    <label for="kids">מספר ילדים (עד גיל 21):</label>
    <input type="number" id="kids" value="0">

    <label for="sibH">מספר אחים לבעל:</label>
    <input type="number" id="sibH" value="0">

    <label for="sibW">מספר אחים לאשה:</label>
    <input type="number" id="sibW" value="0">

    <button id="calcElig" class="calc">חשב זכאות</button>
    <div id="eligSummary" class="summary"></div>
  </section>

  <!-- לשונית 3: הגשה -->
  <section id="tab-app">
    <h2>הגשת משכנתא דיגיטלית</h2>
    <form id="appForm" action="mailto:mayfn2021@gmail.com" method="post" enctype="text/plain">
      <label for="appName">שם מלא:</label>
      <input type="text" id="appName" name="שם">

      <label for="appPhone">טלפון:</label>
      <input type="tel" id="appPhone" name="טלפון">

      <label for="appEmail">אימייל:</label>
      <input type="email" id="appEmail" name="אימייל">

      <label for="appAmount">סכום משכנתא רצוי (₪):</label>
      <input type="number" id="appAmount" name="סכום">

      <label for="appAddress">כתובת נכס:</label>
      <input type="text" id="appAddress" name="כתובת">

      <label for="appDate">תאריך רכישה:</label>
      <input type="date" id="appDate" name="תאריך">

      <button type="submit" class="calc">שלח בקשה</button>
    </form>
  </section>

  <script>
    // ניווט בין לשוניות
    ['plan','elig','app'].forEach(tab=>{
      document.getElementById('btn-'+tab).onclick = () => {
        ['plan','elig','app'].forEach(t=>{
          document.getElementById('tab-'+t).classList.remove('active');
          document.getElementById('btn-'+t).classList.remove('active');
        });
        document.getElementById('tab-'+tab).classList.add('active');
        document.getElementById('btn-'+tab).classList.add('active');
      };
    });

    // ---- מחשבון מסלולים ----
    const planTbody = document.querySelector('#planTable tbody');
    document.getElementById('addPlan').onclick = addPlanRow;

    function addPlanRow(){
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>
          <select class="planType">
            <option>רגיל</option>
            <option>צמוד</option>
            <option>משתנה</option>
          </select>
        </td>
        <td><input type="number" class="planAmt" value="0"></td>
        <td><input type="number" class="planTerm" value="20"></td>
        <td><input type="number" class="planRate" value="3.5" step="0.01"></td>
        <td class="planPay">0</td>
        <td class="planCost">0</td>
        <td><button class="remove">×</button></td>`;
      planTbody.appendChild(tr);
      tr.querySelector('.remove').onclick = () => { tr.remove(); calcPlan(); };
      ['planAmt','planTerm','planRate'].forEach(cls=>{
        tr.querySelector('.'+cls).oninput = calcPlan;
      });
      calcPlan();
    }

    function calcPlan(){
      let totalP=0, totalM=0, totalCost=0;
      planTbody.querySelectorAll('tr').forEach(tr=>{
        const P = +tr.querySelector('.planAmt').value;
        const yrs = +tr.querySelector('.planTerm').value;
        const r = +tr.querySelector('.planRate').value/100/12;
        const n = yrs*12;
        const M = r>0 ? (P*r*Math.pow(1+r,n))/(Math.pow(1+r,n)-1) : P/n;
        const cost = M*n;
        tr.querySelector('.planPay').textContent = M.toFixed(2);
        tr.querySelector('.planCost').textContent = cost.toFixed(2);
        totalP += P; totalM += M; totalCost += cost;
      });
      document.getElementById('planSummary').innerHTML = `
        <p>סה"כ קרן: ₪${totalP.toFixed(2)}</p>
        <p>סה"כ החזר חודשי: ₪${totalM.toFixed(2)}</p>
        <p>סה"כ עלות: ₪${totalCost.toFixed(2)}</p>`;
    }

    // ---- מחשבון זכאות ----
    document.getElementById('calcElig').onclick = () => {
      const svcH = +document.getElementById('svcH').value;
      const svcW = +document.getElementById('svcW').value;
      const kids = +document.getElementById('kids').value;
      const sibH = +document.getElementById('sibH').value;
      const sibW = +document.getElementById('sibW').value;
      // חישוב שנות נישואין
      let yrs = 0;
      const md = document.getElementById('marriageDate').value;
      if (md) {
        const diff = (new Date() - new Date(md)) / (1000*60*60*24*365);
        yrs = Math.floor(diff);
      }
      // ניקוד דוגמה: חודש שירות = 1 נקודה, ילד = 10, אח = 5, שנה נישואין = 5
      let points = svcH + svcW + kids*10 + sibH*5 + sibW*5 + yrs*5;
      const elig = points >= 50;  // סף מומלץ
      document.getElementById('eligSummary').innerHTML = `
        <p>סה"כ נקודות: <strong>${points}</strong></p>
        <p>${elig 
          ? '<span style="color:green">אתה עשוי להיות זכאי!</span>' 
          : '<span style="color:red">ייתכן ואינך עומד בקריטריונים.</span>'}
        </p>`;
    };
  </script>

</body>
</html>
